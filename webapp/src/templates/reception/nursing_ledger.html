<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<title>Ø¯ÙØªØ± Ø®Ø¯Ù…Ø§Øª Ù¾Ø±Ø³ØªØ§Ø±ÛŒ Ø´ÛŒÙØª Ø¬Ø§Ø±ÛŒ</title>
<link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/misc/Farsi-Digits/font-face.css" rel="stylesheet" type="text/css" />
<style>
    /* ØªÙ… Ù…ÛŒÙ†ÛŒÙ…Ø§Ù„ Ùˆ Ù…Ø¯Ø±Ù† */
    :root { --bg:#f3f4f6; --card:#fff; --text:#111827; --accent:#6366f1; --border:#d1d5db; --thead:#f9fafb; }
    body.theme-dark { --bg:#030712; --card:#1f2937; --text:#f9fafb; --accent:#818cf8; --border:#374151; --thead:#111827; }
    body.theme-dark tr:hover td{background:#1e1b4b !important;}
    body {font-family:'Vazirmatn', Tahoma, sans-serif; background:var(--bg); margin:0; padding:1.2rem; color:var(--text);}
    .card {background:#fff; border-radius:14px; padding:1.2rem 1.4rem; box-shadow:0 4px 10px -2px rgba(0,0,0,0.05); margin-bottom:1.2rem;}
    h1 {margin:0 0 1rem; font-size:1.3rem;}
    .summary {display:flex; gap:1rem; flex-wrap:wrap;}
    .summary-box {background:#f8fafc; border:1px solid #e2e8f0; padding:0.9rem 1.1rem; border-radius:10px; min-width:160px; display:flex; flex-direction:column; gap:0.3rem;}
    .summary-box span:first-child {font-size:0.75rem; color:#64748b; font-weight:600;}
    .summary-box .val {font-size:1.2rem; font-weight:800;}
    table {width:100%; border-collapse:separate; border-spacing:0; direction:rtl;}
    th {background:#f8fafc; font-weight:700; font-size:0.75rem; padding:0.7rem 0.6rem; text-align:right; white-space:nowrap; border-bottom:2px solid #e2e8f0; color:#64748b;}
    td {padding:0.6rem 0.6rem; font-size:0.78rem; border-bottom:1px solid #f1f5f9; vertical-align:middle;}
    tr:hover td {background:#fafafa;}
    .badge {padding:0.25rem 0.55rem; border-radius:6px; background:#eef2ff; color:#4f46e5; font-size:0.65rem; font-weight:700;}
    .top-actions {display:flex; justify-content:space-between; align-items:center; margin-bottom:0.8rem;}
    .btn {cursor:pointer; background:#4f46e5; color:#fff; border:none; padding:0.55rem 1rem; font-family:inherit; font-size:0.75rem; border-radius:8px; font-weight:600; text-decoration:none; display:inline-flex; align-items:center;}
    .btn.outline {background:#fff; color:#4f46e5; border:1px solid #4f46e5;}
    .empty {text-align:center; padding:3rem 1rem; color:#64748b;}
</style>
</head>
<body>
    <div class="card">
        <div class="top-actions">
            <h1>Ø¯ÙØªØ± Ø®Ø¯Ù…Ø§Øª Ù¾Ø±Ø³ØªØ§Ø±ÛŒ Ø´ÛŒÙØª Ø¬Ø§Ø±ÛŒ</h1>
            <div style="display:flex; gap:0.5rem;">
                <a class="btn outline" href="{{ url_for('reception.index') }}">â¬… Ø¨Ø§Ø²Ú¯Ø´Øª</a>
                <button class="btn" onclick="window.print()">ğŸ–¨ Ú†Ø§Ù¾</button>
            </div>
        </div>
        <div style="font-size:0.75rem; color:#475569; margin-bottom:0.8rem;">
            Ø´ÛŒÙØª: <strong>{{ 'ØµØ¨Ø­' if shift=='morning' else ('Ø¹ØµØ±' if shift=='evening' else 'Ø´Ø¨') }}</strong>
            | Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ: {{ start.strftime('%Y-%m-%d %H:%M') | jalali_datetime }} ØªØ§ {{ end.strftime('%Y-%m-%d %H:%M') | jalali_datetime }}
        </div>
        <div class="summary">
            <div class="summary-box">
                <span>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ø®Ø¯Ù…Ø§Øª</span>
                <div class="val">{{ total_services }}</div>
            </div>
            <div class="summary-box">
                <span>Ù…Ø¬Ù…ÙˆØ¹ Ù…Ø¨Ø§Ù„Øº (ØªÙˆÙ…Ø§Ù†)</span>
                <div class="val">{{ '{:,}'.format(total_amount|int) }}</div>
            </div>
        </div>
    </div>
    <div class="card">
        {% if injections %}
        <div style="overflow:auto;">
            <table>
                <thead>
                    <tr>
                        <th>Ø²Ù…Ø§Ù†</th>
                        <th>Ø¨ÛŒÙ…Ø§Ø±</th>
                        <th>Ù†ÙˆØ¹ Ø®Ø¯Ù…Øª</th>
                        <th>ØªØ¹Ø¯Ø§Ø¯</th>
                        <th>Ù…Ø¨Ù„Øº ÙˆØ§Ø­Ø¯</th>
                        <th>Ù…Ø¨Ù„Øº Ú©Ù„</th>
                        <th>Ù¾Ø²Ø´Ú©</th>
                        <th>Ù¾Ø±Ø³ØªØ§Ø±</th>
                        <th>ÛŒØ§Ø¯Ø¯Ø§Ø´Øª</th>
                    </tr>
                </thead>
                <tbody>
                    {% for r in injections %}
                    <tr>
                        <td>{{ r.injection_date | jalali_datetime }}</td>
                        <td style="font-weight:600;">{{ r.patient_name }}</td>
                        <td><span class="badge">{{ r.injection_type }}</span></td>
                        <td>{{ r.count }}</td>
                        <td>{{ '{:,}'.format((r.unit_price or 0)|int) }}</td>
                        <td style="font-weight:700;">{{ '{:,}'.format((r.total_price or 0)|int) }}</td>
                        <td style="color:#334155;">{{ r.doctor_name or 'â€”' }}</td>
                        <td style="color:#334155;">{{ r.nurse_name or 'â€”' }}</td>
                        <td style="max-width:180px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;" title="{{ r.notes }}">{{ r.notes or 'â€”' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty">
            <h3 style="margin:0 0 0.5rem; font-size:1rem;">Ù‡ÛŒÚ† Ø®Ø¯Ù…Ø§ØªÛŒ Ø¯Ø± Ø§ÛŒÙ† Ø´ÛŒÙØª Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</h3>
            <p style="margin:0; font-size:0.75rem;">Ø¨Ø±Ø§ÛŒ Ø«Ø¨ØªØŒ Ø§Ø² Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù¾Ø°ÛŒØ±Ø´ Ø§Ù‚Ø¯Ø§Ù… Ú©Ù†ÛŒØ¯.</p>
        </div>
        {% endif %}
    </div>
</body>
</html>